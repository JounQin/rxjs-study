(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{158:function(e,t,n){"use strict";n.r(t);var s=n(1),i=n.n(s),a=n(7),o=n(52),c=n.n(o),r=(n(97),n(55)),l=n.n(r),d=(n(62),n(85)),h=n.n(d),p=(n(242),n(81)),u=n.n(p),b=(n(128),n(335)),m=n(221),$=n(155),g=n(336),P=n(328),O=n(69),f=n(332),j=n(334),E=n(333),v=n(329),C=n(331),w=n(84);class x extends s.PureComponent{constructor(){super(...arguments),this.state={value:null}}componentDidMount(){this.setupSubscription()}setupSubscription(){this.subscription=this.props.children.subscribe(e=>{this.setState({value:e})})}teardownSubscription(){this.subscription&&this.subscription.unsubscribe()}componentDidUpdate(e){e.children!==this.props.children&&(this.teardownSubscription(),this.setupSubscription())}componentWillUnmount(){this.teardownSubscription()}render(){return this.state.value}}const y=e=>{const t=[];return e.forEach(e=>"string"==typeof e?t.push(e):Object.keys(e).forEach(n=>{e[n]&&t.push(n)})),t};var I=n(56),k=n.n(I);const S=k.a.create()(class extends s.PureComponent{constructor(){super(...arguments),this.onPostTitleChange=(e=>{this.title=e.target.value}),this.onPostBodyChange=(e=>{this.body=e.target.value}),this.onCancel=(()=>this.props.visible$.next(!1)),this.onOk=(()=>this.props.addingPost$.next({title:this.title,body:this.body}))}render(){const{form:{getFieldDecorator:e},visible$:t}=this.props;return i.a.createElement(x,null,t.pipe(Object(O.a)(t=>i.a.createElement(u.a,{visible:t,title:"Create a new Post",okText:"Create",onCancel:this.onCancel,onOk:this.onOk},i.a.createElement(k.a,null,i.a.createElement(k.a.Item,{label:"Title"},e("title",{rules:[{required:!0,message:"Please input the title of post!"}]})(i.a.createElement(l.a,{onChange:this.onPostTitleChange}))),i.a.createElement(k.a.Item,{label:"Description"},e("description")(i.a.createElement(l.a,{type:"textarea",onChange:this.onPostBodyChange}))))))))}});n(162);const D=(e=>new class{constructor(e){this.namespace=e}block(...e){return y(e).reduce((e,t)=>`${e} ${this.namespace}--${t}`,this.namespace)}element(e,...t){return y(t).reduce((t,n)=>`${t} ${this.namespace}__${e}--${n}`,`${this.namespace}__${e}`)}}(e))("app");class N extends i.a.PureComponent{constructor(){super(...arguments),this.search$=new g.a(""),this.visible$=new g.a(!1),this.loading$=new g.a(!1),this.addingPost$=new $.a,this.addedPost$=this.addingPost$.pipe(Object(E.a)(e=>!(!e.title||!e.body)),Object(v.a)(500),Object(f.a)(()=>this.loading$.next(!0)),Object(C.a)(e=>w.a.createPost(e)),Object(j.a)(()=>Object(m.a)(null)),Object(f.a)(()=>this.loading$.next(!1)),Object(P.a)(null)),this.deletingPostId$=new $.a,this.deletedPostId$=this.deletingPostId$.pipe(Object(f.a)(()=>this.loading$.next(!0)),Object(C.a)(e=>w.a.deletePost(e)),Object(j.a)(()=>Object(m.a)(null)),Object(f.a)(()=>this.loading$.next(!1)),Object(P.a)(null)),this.posts$=Object(b.a)(w.a.getPosts(),this.addedPost$,this.deletedPostId$).pipe(Object(f.a)(([e,t,n])=>{if(t&&!e.includes(t))return e.splice(0,0,t),void this.visible$.next(!1);if(!n)return;const s=e.findIndex(e=>e.id===n);s+1&&e.splice(s,1)}),Object(O.a)(([e])=>e)),this.onChange=(e=>this.search$.next(e.target.value.trim())),this.createPost=(()=>this.visible$.next(!0)),this.saveFormRef=(e=>{this.formRef=e})}deletePost(e){u.a.confirm({title:"Delete",content:"Do you confirm to delete this post?",onOk:()=>this.deletingPostId$.next(e)})}render(){return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:D.element("header")},i.a.createElement(l.a.Search,{onChange:this.onChange}),i.a.createElement("div",{className:D.element("add-post")},i.a.createElement(c.a,{onClick:this.createPost},"Add Post"))),i.a.createElement(x,null,Object(b.a)(this.posts$,this.search$,this.loading$).pipe(Object(O.a)(([e,t,n])=>(e=t?e.filter(e=>e.title.includes(t)):e,i.a.createElement(h.a,{className:D.element("list"),bordered:!0,dataSource:e,loading:n,rowKey:"id",renderItem:e=>i.a.createElement(h.a.Item,{actions:[i.a.createElement("a",{onClick:()=>this.deletePost(e.id)},"delete")]},i.a.createElement(h.a.Item.Meta,{title:e.title,description:e.body}))}))))),i.a.createElement(S,{wrappedComponentRef:this.saveFormRef,addingPost$:this.addingPost$,visible$:this.visible$}))}}(()=>Object(a.render)(i.a.createElement(N,null),document.getElementById("app")))()},162:function(e,t,n){},224:function(e,t,n){},229:function(e,t,n){},232:function(e,t,n){},235:function(e,t,n){},238:function(e,t,n){},241:function(e,t,n){},271:function(e,t,n){},277:function(e,t,n){},30:function(e,t,n){},84:function(e,t,n){"use strict";(function(e){var s=n(37),i=n(118),a=n(69);const o=e.env.SERVER_ENDPOINT||"https://jsonplaceholder.typicode.com/";t.a=new class{getPosts(){return Object(s.a)(i.a.getJSON(o+"posts").toPromise())}createPost(e){return i.a.post(o+"posts",e,{"Content-Type":"application/json"}).pipe(Object(a.a)(({response:e})=>e))}deletePost(e){return Object(s.a)(i.a.delete(o+"posts/"+e).pipe(Object(a.a)(()=>e)).toPromise().catch(()=>null))}}}).call(this,n(220))}},[[158,0,1]]]);