(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{157:function(e,t,n){"use strict";n.r(t);var s=n(1),a=n.n(s),i=n(7),o=n(52),c=n.n(o),r=(n(97),n(55)),l=n.n(r),d=(n(62),n(85)),h=n.n(d),p=(n(242),n(81)),u=n.n(p),m=(n(127),n(336)),b=n(335),g=n(221),P=n(154),$=n(69),f=n(328),O=n(332),j=n(334),C=n(331),E=n(329),v=n(333),w=n(84);class x extends s.PureComponent{constructor(e){super(e),this.state={value:null}}componentDidMount(){this.setupSubscription()}setupSubscription(){this.subscription=this.props.children.subscribe(e=>{this.setState({value:e})})}teardownSubscription(){this.subscription&&this.subscription.unsubscribe()}componentDidUpdate(e){e.children!==this.props.children&&(this.teardownSubscription(),this.setupSubscription())}componentWillUnmount(){this.teardownSubscription()}render(){return this.state.value}}const y=e=>{const t=[];return e.forEach(e=>"string"==typeof e?t.push(e):Object.keys(e).forEach(n=>{e[n]&&t.push(n)})),t};var I=n(56),S=n.n(I);const k=S.a.create()(class extends s.PureComponent{constructor(){super(...arguments),this.addingPost={},this.onPostTitleChange=(e=>{this.addingPost.title=e.target.value}),this.onPostBodyChange=(e=>{this.addingPost.body=e.target.value}),this.onCreate=(e=>{e.preventDefault(),this.props.onCreate(this.addingPost)})}render(){const{visible:e,onCancel:t,form:{getFieldDecorator:n}}=this.props;return a.a.createElement(u.a,{visible:e,title:"Create a new Post",okText:"Create",onCancel:t,onOk:this.onCreate},a.a.createElement(S.a,null,a.a.createElement(S.a.Item,{label:"Title"},n("title",{rules:[{required:!0,message:"Please input the title of post!"}]})(a.a.createElement(l.a,{onChange:this.onPostTitleChange}))),a.a.createElement(S.a.Item,{label:"Description"},n("description")(a.a.createElement(l.a,{type:"textarea",onChange:this.onPostBodyChange})))))}});n(161);const D=(e=>new class{constructor(e){this.namespace=e}block(...e){return y(e).reduce((e,t)=>`${e} ${this.namespace}--${t}`,this.namespace)}element(e,...t){return y(t).reduce((t,n)=>`${t} ${this.namespace}__${e}--${n}`,`${this.namespace}__${e}`)}}(e))("app");class N extends a.a.PureComponent{constructor(){super(...arguments),this.search$=new m.a(""),this.visible$=new m.a(!1),this.loading$=new m.a(!1),this.addingPost$=new P.a,this.addedPost$=this.addingPost$.pipe(Object(v.a)(e=>!(!e.title||!e.body)),Object(E.a)(500),Object(O.a)(()=>this.loading$.next(!0)),Object(C.a)(e=>w.a.createPost(e)),Object(j.a)(()=>Object(g.a)(null)),Object(O.a)(()=>this.loading$.next(!1)),Object(f.a)(null)),this.deletingPostId$=new P.a,this.deletedPostId$=this.deletingPostId$.pipe(Object(O.a)(()=>this.loading$.next(!0)),Object(C.a)(e=>w.a.deletePost(e)),Object(j.a)(()=>Object(g.a)(null)),Object(O.a)(()=>this.loading$.next(!1)),Object(f.a)(null)),this.posts$=Object(b.a)(w.a.getPosts(),this.addedPost$,this.deletedPostId$).pipe(Object(O.a)(([e,t,n])=>{if(t&&!e.includes(t))return e.splice(0,0,t),void this.visible$.next(!1);if(!n)return;const s=e.findIndex(e=>e.id===n);s+1&&e.splice(s,1)}),Object($.a)(([e])=>e)),this.onChange=(e=>this.search$.next(e.target.value.trim())),this.createPost=(()=>this.visible$.next(!0)),this.cancel=(()=>this.visible$.next(!1)),this.confirm=(e=>this.addingPost$.next(e)),this.saveFormRef=(e=>{this.formRef=e})}deletePost(e){u.a.confirm({title:"Delete",content:"Do you confirm to delete this post?",onOk:()=>this.deletingPostId$.next(e)})}render(){return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:D.element("header")},a.a.createElement(l.a.Search,{onChange:this.onChange}),a.a.createElement("div",{className:D.element("add-post")},a.a.createElement(c.a,{onClick:this.createPost},"Add Post"))),a.a.createElement(x,null,Object(b.a)(this.posts$,this.search$,this.loading$).pipe(Object($.a)(([e,t,n])=>(e=t?e.filter(e=>e.title.includes(t)):e,a.a.createElement(h.a,{className:D.element("list"),bordered:!0,dataSource:e,loading:n,rowKey:"id",renderItem:e=>a.a.createElement(h.a.Item,{actions:[a.a.createElement("a",{onClick:()=>this.deletePost(e.id)},"delete")]},a.a.createElement(h.a.Item.Meta,{title:e.title,description:e.body}))}))))),a.a.createElement(x,null,this.visible$.pipe(Object($.a)(e=>a.a.createElement(k,{wrappedComponentRef:this.saveFormRef,visible:e,onCancel:this.cancel,onCreate:this.confirm})))))}}(()=>Object(i.render)(a.a.createElement(N,null),document.getElementById("app")))()},161:function(e,t,n){},224:function(e,t,n){},229:function(e,t,n){},232:function(e,t,n){},235:function(e,t,n){},238:function(e,t,n){},241:function(e,t,n){},271:function(e,t,n){},277:function(e,t,n){},30:function(e,t,n){},84:function(e,t,n){"use strict";(function(e){var s=n(37),a=n(118),i=n(69);const o=e.env.SERVER_ENDPOINT||"https://jsonplaceholder.typicode.com/";t.a=new class{getPosts(){return Object(s.a)(a.a.getJSON(o+"posts").toPromise())}createPost(e){return a.a.post(o+"posts",e,{"Content-Type":"application/json"}).pipe(Object(i.a)(({response:e})=>e))}deletePost(e){return Object(s.a)(a.a.delete(o+"posts/"+e).pipe(Object(i.a)(()=>e)).toPromise().catch(()=>null))}}}).call(this,n(219))}},[[157,0,1]]]);